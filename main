import numpy as np
import random
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
import pandas as pd
import os

def read_file(files_name):
    # Read file and extract data file
    full_path = os.path.abspath(__file__) # Get the full path of the script     
    script_directory = os.path.dirname(full_path) # Get the directory of the script
    data_file = os.path.join(script_directory,files_name[0]) 
    columns_file = os.path.join(script_directory, files_name[1]) # wbcd.names , sonar.names

    columns_name = []

    # Reading Column names from file
    with open(columns_file,'r') as file_: 
        columns = file_.readlines()
        for idx, line in enumerate(columns): # extract values
            if idx == 0: 
                columns_name.append('target_')   # add column for target column
                continue
            x = line.split()
            columns_name.append(x[0])
            #column_data.append(x[1])

    # Reading dataset from file
    with open(data_file,'r') as data_: 
        data = data_.readlines()
        dataset = pd.DataFrame(columns=columns_name)
        for line in data:
            x = line.split(',')
            dataset.loc[len(dataset)] = x

    # Bnary target column: 0: MUSK, 1: NON-MUSK
    dataset['class'] = [0 if row[0:4] == 'MUSK' else 1 for row in dataset['target_'].str.strip()]

    # Apply EDAs 
    dataset = dataset.drop(columns=['molecule_name:', 'conformation_name:', 'f166:','target_'])  # Drop unrelivant columns
                    

    return dataset

def main():
    file_name = ['clean1.data']
    columns_file = ['clean1.names']

    for i, datafile_ in enumerate(file_name):

        # Read dataset and columns from file 
        dataset = read_file(datafile_, columns_file[i])
        Feature = dataset.iloc[:, :-1]  # Features
        Target = dataset.iloc[:, -1]    # Target: 0 (MUSK) or 1 (NON-MSK)

